<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ì–æ–ª—å—Ñ: –°–ò–õ–ê</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #1b3a2a;
      color: #e0f7e0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      color: #4caf50;
      margin-bottom: 10px;
      text-align: center;
    }

    #container {
      position: relative;
      width: 900px;
      height: 500px;
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.6);
      margin-bottom: 20px;
      background: #388e3c;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }

    #info {
      max-width: 900px;
      background: #263238;
      padding: 20px;
      border-radius: 12px;
      border-left: 5px solid #00bcd4;
      line-height: 1.6;
      font-size: 15px;
    }

    .formula {
      background: #1a2327;
      padding: 8px 12px;
      border-radius: 6px;
      font-family: monospace;
      display: inline-block;
      margin: 8px 0;
      color: #80deea;
    }

    #level {
      position: absolute;
      top: 15px;
      left: 15px;
      background: rgba(0,0,0,0.6);
      color: #ffeb3b;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: bold;
      z-index: 5;
    }

    #message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.85);
      color: #69f0ae;
      padding: 14px 28px;
      border-radius: 10px;
      font-size: 22px;
      font-weight: bold;
      display: none;
      text-align: center;
      z-index: 10;
    }
  </style>
</head>
<body>

<h1>‚õ≥ –ì–æ–ª—å—Ñ: –°–ò–õ–ê –£–î–ê–†–ê</h1>

<div id="container">
  <div id="level">–õ—É–Ω–∫–∞: <span id="level-num">1</span>/5</div>
  <div id="message">–û—Ç–ª–∏—á–Ω—ã–π —É–¥–∞—Ä! üéØ</div>
  <canvas id="course" width="900" height="500"></canvas>
</div>

<div id="info">
  <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ –°–ò–õ–ê –≤ –≥–æ–ª—å—Ñ–µ?</h3>
  <p>
    <strong>–°–∏–ª–∞ —É–¥–∞—Ä–∞</strong> ‚Äî —ç—Ç–æ —Ç–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Ç—ã "—Ç–æ–ª–∫–∞–µ—à—å" –º—è—á –∫–ª—é—à–∫–æ–π. 
    –í —ç—Ç–æ–π –∏–≥—Ä–µ —Å–∏–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è <strong>–¥–ª–∏–Ω–æ–π —Ä–∞—Å—Ç—è–∂–∫–∏</strong>: —á–µ–º –¥–∞–ª—å—à–µ —Ç—ã —Ç—è–Ω–µ—à—å –º—ã—à–∫—É –æ—Ç –º—è—á–∞, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —É–¥–∞—Ä.
  </p>
  <p>
    –°–∏–ª–∞ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ <strong>–Ω–∞—á–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å</strong –º—è—á–∞:
    —á–µ–º –±–æ–ª—å—à–µ —Å–∏–ª–∞ ‚Üí —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª–µ—Ç–∏—Ç –º—è—á ‚Üí —Ç–µ–º –¥–∞–ª—å—à–µ –æ–Ω –ø—Ä–æ–∫–∞—Ç–∏—Ç—Å—è.
  </p>

  <h4>–§–æ—Ä–º—É–ª—ã —Å–∏–ª—ã:</h4>
  <p>
    <span class="formula">F = m ¬∑ a</span> ‚Äî —Å–∏–ª–∞ = –º–∞—Å—Å–∞ √ó —É—Å–∫–æ—Ä–µ–Ω–∏–µ.  
    –ü—Ä–∏ —É–¥–∞—Ä–µ –∫–ª—é—à–∫–æ–π –º—è—á—É —Å–æ–æ–±—â–∞–µ—Ç—Å—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ ‚Äî –∏ –æ–Ω –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å.
  </p>
  <p>
    <span class="formula">v‚ÇÄ = k ¬∑ F</span> ‚Äî –Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Å–∏–ª–µ —É–¥–∞—Ä–∞.  
    –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ —Ç—è–Ω—É—Ç—å —Å–ª–∞–±–æ ‚Äî –º—è—á –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–ª–∏–∑–∫–æ, –∞ –µ—Å–ª–∏ —Å–∏–ª—å–Ω–æ ‚Äî –¥–æ–ª–µ—Ç–∏—Ç –¥–æ –ª—É–Ω–∫–∏!
  </p>
</div>

<script>
  const canvas = document.getElementById('course');
  const ctx = canvas.getContext('2d');
  const messageEl = document.getElementById('message');
  const levelNumEl = document.getElementById('level-num');

  // –£—Ä–æ–≤–Ω–∏: –≤—Å—ë –≤–Ω—É—Ç—Ä–∏ 900x500
  const levels = [
    { ball: { x: 150, y: 400 }, hole: { x: 350, y: 350 } },
    { ball: { x: 500, y: 150 }, hole: { x: 700, y: 200 } },
    { ball: { x: 200, y: 250 }, hole: { x: 280, y: 180 } },
    { ball: { x: 600, y: 400 }, hole: { x: 800, y: 380 } },
    { ball: { x: 450, y: 300 }, hole: { x: 600, y: 150 } }
  ];

  let currentLevel = 0;
  let ball = { x: 0, y: 0, vx: 0, vy: 0, radius: 16, active: true }; // –ë–û–õ–¨–®–ï —Ä–∞–¥–∏—É—Å
  let hole = { x: 0, y: 0, radius: 28 }; // –ë–û–õ–¨–®–ï –ª—É–Ω–∫–∞

  function loadLevel(index) {
    const lvl = levels[index];
    ball.x = lvl.ball.x;
    ball.y = lvl.ball.y;
    ball.vx = 0;
    ball.vy = 0;
    ball.active = true;
    hole.x = lvl.hole.x;
    hole.y = lvl.hole.y;
    levelNumEl.textContent = index + 1;
    messageEl.style.display = 'none';
  }

  let isAiming = false;
  let aimVector = { x: 0, y: 0 };

  canvas.addEventListener('mousedown', (e) => {
    if (!ball.active) return;
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;

    const dx = mx - ball.x;
    const dy = my - ball.y;
    if (Math.hypot(dx, dy) <= ball.radius + 8) {
      isAiming = true;
      aimVector.x = 0;
      aimVector.y = 0;
    }
  });

  canvas.addEventListener('mousemove', (e) => {
    if (!isAiming) return;
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;

    aimVector.x = mx - ball.x;
    aimVector.y = my - ball.y;

    const maxLen = 180; // –º–æ–∂–Ω–æ —Ç—è–Ω—É—Ç—å –¥–∞–ª—å—à–µ
    const len = Math.hypot(aimVector.x, aimVector.y);
    if (len > maxLen) {
      aimVector.x = (aimVector.x / len) * maxLen;
      aimVector.y = (aimVector.y / len) * maxLen;
    }
  });

  canvas.addEventListener('mouseup', () => {
    if (isAiming) {
      const power = 0.1; // —á—É—Ç—å –º—è–≥—á–µ
      ball.vx = aimVector.x * power;
      ball.vy = aimVector.y * power;
      isAiming = false;
    }
  });

  const friction = 0.98;

  function update() {
    if (!ball.active) return;

    ball.x += ball.vx;
    ball.y += ball.vy;

    ball.vx *= friction;
    ball.vy *= friction;

    if (Math.abs(ball.vx) < 0.02 && Math.abs(ball.vy) < 0.02) {
      ball.vx = 0;
      ball.vy = 0;
    }

    // –ì—Ä–∞–Ω–∏—Ü—ã
    if (ball.x < ball.radius) ball.x = ball.radius, ball.vx *= -0.5;
    if (ball.x > canvas.width - ball.radius) ball.x = canvas.width - ball.radius, ball.vx *= -0.5;
    if (ball.y < ball.radius) ball.y = ball.radius, ball.vy *= -0.5;
    if (ball.y > canvas.height - ball.radius) ball.y = canvas.height - ball.radius, ball.vy *= -0.5;

    // –ü–æ–ø–∞–¥–∞–Ω–∏–µ
    const dx = ball.x - hole.x;
    const dy = ball.y - hole.y;
    const dist = Math.hypot(dx, dy);
    const speed = Math.hypot(ball.vx, ball.vy);

    if (dist < hole.radius - 6 && speed < 2.0) {
      ball.active = false;
      messageEl.style.display = 'block';

      setTimeout(() => {
        currentLevel++;
        if (currentLevel >= levels.length) {
          messageEl.innerHTML = '–ü–æ–±–µ–¥–∞! üèÜ<br>–í—Å–µ –ª—É–Ω–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!';
          messageEl.style.color = '#ffeb3b';
          setTimeout(() => {
            currentLevel = 0;
            loadLevel(currentLevel);
          }, 3000);
        } else {
          loadLevel(currentLevel);
        }
      }, 1800);
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // –¢—Ä–∞–≤–∞
    ctx.fillStyle = '#4caf50';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // –õ—É–Ω–∫–∞
    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.arc(hole.x, hole.y, hole.radius, 0, Math.PI * 2);
    ctx.fill();

    // –§–ª–∞–≥
    ctx.strokeStyle = '#5d4037';
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.moveTo(hole.x, hole.y - hole.radius - 8);
    ctx.lineTo(hole.x, hole.y - hole.radius - 50);
    ctx.stroke();

    ctx.fillStyle = '#f44336';
    ctx.beginPath();
    ctx.moveTo(hole.x, hole.y - hole.radius - 50);
    ctx.lineTo(hole.x + 20, hole.y - hole.radius - 35);
    ctx.lineTo(hole.x, hole.y - hole.radius - 20);
    ctx.closePath();
    ctx.fill();

    // –ú—è—á
    if (ball.active) {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
      ctx.fillStyle = '#ffffff';
      ctx.fill();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      ctx.stroke();

      // –ë–ª–∏–∫ (–∫—Ä—É–ø–Ω–µ–µ)
      ctx.beginPath();
      ctx.arc(ball.x - 6, ball.y - 6, 6, 0, Math.PI * 2);
      ctx.fillStyle = '#fff';
      ctx.fill();
    }

    // –°—Ç—Ä–µ–ª–∫–∞
    if (isAiming) {
      const ax = ball.x + aimVector.x;
      const ay = ball.y + aimVector.y;

      ctx.beginPath();
      ctx.moveTo(ball.x, ball.y);
      ctx.lineTo(ax, ay);
      ctx.strokeStyle = 'rgba(255,255,255,0.95)';
      ctx.lineWidth = 3;
      ctx.stroke();

      const angle = Math.atan2(aimVector.y, aimVector.x);
      const as = 16;
      ctx.beginPath();
      ctx.moveTo(ax, ay);
      ctx.lineTo(ax - as * Math.cos(angle - Math.PI/6), ay - as * Math.sin(angle - Math.PI/6));
      ctx.lineTo(ax - as * Math.cos(angle + Math.PI/6), ay - as * Math.sin(angle + Math.PI/6));
      ctx.closePath();
      ctx.fillStyle = '#ffffff';
      ctx.fill();
    }
  }

  function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }

  loadLevel(currentLevel);
  gameLoop();
</script>

</body>
</html>
